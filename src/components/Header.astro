---
import LanguajePicker from './LanguajePicker.astro';
import { Image } from 'astro:assets';
---

<header class='md:m-2 md:p-2 md:fixed backdrop-blur-sm md:rounded-2xl md:w-full md:z-50 md:mt-12'>
  <div class='flex justify-around'>
    <div class='flex'>
      <Image
        inferSize={true}
        loading='eager'
        class='rounded-full w-12 h-12 mr-4'
        src='https://external-content.duckduckgo.com/iu/?u=https%3A%2F%2Fmedia.licdn.com%2Fdms%2Fimage%2Fv2%2FC4E03AQFUtWKOn67htw%2Fprofile-displayphoto-shrink_200_200%2Fprofile-displayphoto-shrink_200_200%2F0%2F1634309529096%3Fe%3D2147483647%26v%3Dbeta%26t%3D_-cQbsxgTCLOSTXyS4iHFfgLKCdwRNmK2kfDe7Tdk68&f=1&nofb=1&ipt=d3afd5ff7d44a32ce5dbde1d43e686fd03ed6c25c128ca09a973fe8d57a3e97a'
        alt='Imagen de perfilongis'
      />
      <h1 class='text-2xl pochita'>Facundo Diaz | Fullstack Developer</h1>
    </div>

    <button id='menu-btn' aria-label='Open menu' class='m-5 md:hidden flex flex-col justify-between w-7 h-5'>
      <span class='block w-full h-0.5 bg-gray-800 dark:bg-gray-200 transition-all duration-300'></span>
      <span class='block w-full h-0.5 bg-gray-800 dark:bg-gray-200 transition-all duration-300'></span>
      <span class='block w-full h-0.5 bg-gray-800 dark:bg-gray-200 transition-all duration-300'></span>
    </button>
    <div
      class='w-1/2 divnav mx-3 absolute left-0 top-16 bg-white dark:bg-gray-900 shadow-lg rounded-lg p-4 transform transition-all duration-300 ease-in-out translate-x-full opacity-0 pointer-events-none md:translate-x-0 md:opacity-100 md:pointer-events-auto md:static md:block'
    >
      <nav class='flex flex-col items-center md:flex-row md:justify-between pochita text-2xl'>
        <a href='#'>Home</a>
        <a href='#about'>About</a>
        <a href='#skills'>Skills</a>
        <a href='#projects'>Projects</a>
        <a href='#contact'>Contact</a>
        <LanguajePicker />
      </nav>
    </div>
  </div>
</header>

<style>
  /* clase que activa el nav en mobile */
  .divnav.open {
    transform: translateX(0) !important;
    opacity: 1 !important;
    pointer-events: auto !important;
  }

  /* mejora de accesibilidad: evita que el foco quede detrás del overlay cuando está cerrado */
  @media (max-width: 767px) {
    .divnav[aria-hidden='true'] {
      visibility: hidden;
    }
    .divnav[aria-hidden='false'] {
      visibility: visible;
    }
  }
</style>

<script>
  const menuBtn = document.getElementById('menu-btn');
  const nav = document.querySelector('.divnav');

  if (menuBtn && nav) {
    const spans = menuBtn.querySelectorAll('span');

    menuBtn.addEventListener('click', () => {
      // toggle nav (clase .open maneja transform/opacity)
      nav.classList.toggle('open');

      // accesibilidad: aria-hidden
      const isOpen = nav.classList.contains('open');
      nav.setAttribute('aria-hidden', String(!isOpen));

      // Animar hamburguesa -> X
      // top bar
      spans[0].classList.toggle('rotate-50');
      spans[0].classList.toggle('translate-y-2');
      // middle bar
      spans[1].classList.toggle('opacity-0');
      // bottom bar
      spans[2].classList.toggle('-rotate-50');
      spans[2].classList.toggle('-translate-y-2');
    });
  }
</script>
